/*! events-manager v1.0.2 | (c) 2014, 2015 Xavier Boubert. | MIT license */
!function(){"use strict";if(!window.EventsManager){var n=function(){var n=!1;this.stopPropagation=function(){n=!0},this.isStoppedPropagation=function(){return n},this.resetStopPropagation=function(){n=!1}},t=function(){var n={low:-1,normal:0,high:9999999};this.formatPriority=function(t){return("undefined"==typeof t||null===t)&&(t="normal"),"string"==typeof t&&(t in n||(t="normal"),t=n[t]),t},this.sortByPriority=function(n){n.sort(function(n,t){return t.priority-n.priority})}};window.EventsManager=function(){function e(n){return n.split(",").map(function(n){return n.trim()})}function r(n){var t=null;return n=n.split("."),n.length>1?(t=n[0],n=n[1]):n=n[0],{name:n,namespace:t}}function i(n){u[n]&&console.error('EventsManager: Event "'+n+'" is locked for use')}var o=this,a=[],s=[],f=new t,u={},c=new n;this.eventsName=function(){var n=[],t=null;for(t in a)n.push(t);return n},this.eventsStack=function(n){return(a[n]||[]).concat(s)},this.fire=function(n,t){var e=[];if("undefined"!=typeof a[n]){i(n),u[n]=!0,f.sortByPriority(a[n]);for(var r=0,o=a[n].length;o>r;r++){var p=a[n][r]||!1;if(p&&(e.push(p.func.call(c,t)),c.isStoppedPropagation())){c.resetStopPropagation();break}}delete u[n]}if(s.length){f.sortByPriority(s);for(var r=0,o=s.length;o>r;r++){var p=s[r];if(e.push(p.func.call(c,n,t)),c.isStoppedPropagation()){c.resetStopPropagation();break}}}return e},this.on=function(n,t,s){return s=f.formatPriority(s),i(n),e(n).map(function(n){n=r(n),a[n.name]=a[n.name]||[],a[n.name].push({namespace:n.namespace,priority:s,func:t})}),o},this.onSafe=function(n,t,e){return o.removeEvent(n,t),o.on(n,t,e)},this.onAnything=function(n,t,e){return e=f.formatPriority(e),s.push({namespace:n,priority:e,func:t}),o},this.removeEventsNamespace=function(n){var t;for(t in a){for(var e=a[t],r=[],f=e.length-1;f>=0;f--)e[f].namespace!==n&&r.push(e[f]);r.length!==e.length&&(i(t),a[t]=r)}for(var u=[],f=s.length-1;f>=0;f--)s[f].namespace!==n&&u.push(s[f]);return u.length!==s.length&&(s=u),o},this.removeEvent=function(n,t){return i(n),e(n).map(function(n){if(n=r(n),"undefined"!=typeof a[n.name])for(var e=0,i=a[n.name].length;i>e;e++)if((!n.namespace||a[n.name][e].namespace==n.namespace)&&a[n.name][e].func.toString()==t.toString()){a[n.name].splice(e,1);break}for(var e=0,i=s.length;i>e;e++)if((!n.namespace||s[e].namespace==n.namespace)&&s[e].func.toString()==t.toString()){s.splice(e,1);break}}),o},this.removeEvents=function(){a=[],s=[]}}}}();